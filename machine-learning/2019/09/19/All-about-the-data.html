<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Machine Learning, it’s all about the data | The SMC Blog</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Machine Learning, it’s all about the data" />
<meta name="author" content="Eigil Aandahl" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="For my machine learning project, I wanted to see if I could teach my laptop to distinguish between different types of music using a large amount of data. Using metadata from a large dataset for music analysis, I tested different machine learning classifiers with supervised learning to distinguish between tracks labeled belonging to ‘Rock’ and ‘Electronic’. The project was developed using Python and libraries for data analysis and machine learning." />
<meta property="og:description" content="For my machine learning project, I wanted to see if I could teach my laptop to distinguish between different types of music using a large amount of data. Using metadata from a large dataset for music analysis, I tested different machine learning classifiers with supervised learning to distinguish between tracks labeled belonging to ‘Rock’ and ‘Electronic’. The project was developed using Python and libraries for data analysis and machine learning." />
<link rel="canonical" href="https://smc-aau-cph.github.io/smc-cph.github.io/machine-learning/2019/09/19/All-about-the-data.html" />
<meta property="og:url" content="https://smc-aau-cph.github.io/smc-cph.github.io/machine-learning/2019/09/19/All-about-the-data.html" />
<meta property="og:site_name" content="The SMC Blog" />
<meta property="og:image" content="https://smc-aau-cph.github.io/smc-cph.github.io/assets/image/2019_09_20_eigila_data-blur.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-09-19T22:00:00+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://smc-aau-cph.github.io/smc-cph.github.io/assets/image/2019_09_20_eigila_data-blur.jpg" />
<meta property="twitter:title" content="Machine Learning, it’s all about the data" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Eigil Aandahl"},"dateModified":"2019-09-19T22:00:00+00:00","datePublished":"2019-09-19T22:00:00+00:00","description":"For my machine learning project, I wanted to see if I could teach my laptop to distinguish between different types of music using a large amount of data. Using metadata from a large dataset for music analysis, I tested different machine learning classifiers with supervised learning to distinguish between tracks labeled belonging to ‘Rock’ and ‘Electronic’. The project was developed using Python and libraries for data analysis and machine learning.","headline":"Machine Learning, it’s all about the data","image":"https://smc-aau-cph.github.io/smc-cph.github.io/assets/image/2019_09_20_eigila_data-blur.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"https://smc-aau-cph.github.io/smc-cph.github.io/machine-learning/2019/09/19/All-about-the-data.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://smc-aau-cph.github.io/smc-cph.github.io/assets/image/2022_07_20_stefanof_SMC_logo_grey.png"},"name":"Eigil Aandahl"},"url":"https://smc-aau-cph.github.io/smc-cph.github.io/machine-learning/2019/09/19/All-about-the-data.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://smc-aau-cph.github.io/smc-cph.github.io/feed.xml" title="The SMC Blog" /></head>
<body><header class="site-header" role="banner"><div class="hamburger-menu-container">
  <nav>
    <ul>
      
      <li class="page-link-hamburger">
        

        <a href="#" class="drop-btn-hamburger" onclick="handleMenuClick(this)"
          >Topics</a
        >
        <ul class="dropdown-hamburger">
          
          <li><a href="/interactive-music/">New Interfaces for Musical Expression (NIME)</a></li>
          
          <li><a href="/machine-learning/">Machine Learning for Media Experiences</a></li>
          
          <li><a href="/motion-capture/">Embodied Interaction</a></li>
          
          <li><a href="/networked-music/">Networked Music</a></li>
          
          <li><a href="/sonification/">Sonification</a></li>
          
          <li><a href="/sound-programming/">Sound Processing</a></li>
          
          <li><a href="/spatial-audio/">Spatial User Interfaces</a></li>
          
          <li><a href="/other/">Other</a></li>
          
          <li><a href="/alltopics/">All Topics</a></li>
          
        </ul>

        
      </li>
      
      <li class="page-link-hamburger">
        

        <a href="#" class="drop-btn-hamburger" onclick="handleMenuClick(this)"
          >Projects</a
        >
        <ul class="dropdown-hamburger">
          
          <li><a href="/mini-projects/">Course Mini Projects</a></li>
          
          <li><a href="/applied-projects/">Semester Projects</a></li>
          
          <li><a href="/masters-thesis/">Master's Theses</a></li>
          
          <li><a href="/projects/">All Projects</a></li>
          
        </ul>

        
      </li>
      
      <li class="page-link-hamburger">
        
        <a href="/people/">People</a>
        
      </li>
      
      <li class="page-link-hamburger">
        
        <a href="/about/">About</a>
        
      </li>
      
      <li class="page-link-hamburger">
        
        <a href="/Guides/">Guides</a>
        
      </li>
      
      <li class="page-link-hamburger">
        
        <a href="/search/">Search</a>
        
      </li>
      
    </ul>
  </nav>
</div>
<div class="wrapper">
        <div class="title-and-logo-wrapper">
            <a href="/">
                <img class="site-logo" src="/assets/image/2022_07_20_stefanof_SMC_logo_grey.png" />
            </a>
            <p class="site-title">
            The SMC Blog
            </p>
        </div>

        <nav class="site-nav">
        <ul>
            
            <li class="page-link">
            

                <a href='#' class="drop-btn" onclick="handleMenuClick(this)">Topics</a>
                <ul class="dropdown">
                
                <li><a href="/interactive-music/">New Interfaces for Musical Expression (NIME)</a></li>
                
                <li><a href="/machine-learning/">Machine Learning for Media Experiences</a></li>
                
                <li><a href="/motion-capture/">Embodied Interaction</a></li>
                
                <li><a href="/networked-music/">Networked Music</a></li>
                
                <li><a href="/sonification/">Sonification</a></li>
                
                <li><a href="/sound-programming/">Sound Processing</a></li>
                
                <li><a href="/spatial-audio/">Spatial User Interfaces</a></li>
                
                <li><a href="/other/">Other</a></li>
                
                <li><a href="/alltopics/">All Topics</a></li>
                
                </ul>

            
            </li>
            
            <li class="page-link">
            

                <a href='#' class="drop-btn" onclick="handleMenuClick(this)">Projects</a>
                <ul class="dropdown">
                
                <li><a href="/mini-projects/">Course Mini Projects</a></li>
                
                <li><a href="/applied-projects/">Semester Projects</a></li>
                
                <li><a href="/masters-thesis/">Master's Theses</a></li>
                
                <li><a href="/projects/">All Projects</a></li>
                
                </ul>

            
            </li>
            
            <li class="page-link">
            
                <a href="/people/">People</a>
            
            </li>
            
            <li class="page-link">
            
                <a href="/about/">About</a>
            
            </li>
            
            <li class="page-link">
            
                <a href="/Guides/">Guides</a>
            
            </li>
            
            <li class="page-link">
            
                <a href="/search/">Search</a>
            
            </li>
            
        </ul>
        </nav>
        <nav class="hamburger-icon-nav"><div class="hamburger-icon-container" onclick="handleHamburgerClick(this)">
  <div class="hamburger-icon-div hamburger-bar1"></div>
  <div class="hamburger-icon-div hamburger-bar2"></div>
  <div class="hamburger-icon-div hamburger-bar3"></div>
</div>
</nav>
    </div>

  <script src="/utils/jquery.js"></script>
  <script src="/utils/hamburger-nav.js"></script>
  <script src="/utils/nav-dropdown-click-handler.js"></script>
</header>
<main class="page-content" aria-label="Content">

      <div class="wrapper">
        <article
  class="post h-entry"
  itemscope
  itemtype="http://schema.org/BlogPosting"
>
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline" align="left">
      Machine Learning, it&#39;s all about the data
    </h1>
    <p class="post-meta">
      <time
        class="dt-published"
        datetime="2019-09-19T22:00:00+00:00"
        itemprop="datePublished"
      >Sep 19, 2019 •
      </time>
          Eigil Aandahl   </p>
  </header>

  <div class="post-content" itemprop="articleBody"><p>For my machine learning project, I wanted to see if I could teach my laptop to distinguish between different types of music using a large amount of data.
Using metadata from a large dataset for music analysis, I tested different machine learning classifiers with supervised learning to distinguish between tracks labeled belonging to ‘Rock’ and ‘Electronic’. The project was developed using Python and libraries for data analysis and machine learning.
I managed to make some progress in the end, but these things take time, so it is merely a preliminary dip into what machine learning can accomplish.</p>

<h3 id="the-dataset">The dataset</h3>
<p>Sourcing or collecting data can be both costly and time consuming, but luckily for me and others looking for large amounts of music data, someone has already done the work for us. I was lucky enough to find a dataset that was both large and applicable for the task at hand.
<a href="https://github.com/mdeff/fma">FMA: A Dataset for Music Analysis</a> is a large dataset containing free and legal music along with metadata and extracted features.
The dataset is sourced from <a href="https://freemusicarchive.org/">The Free Music Archive</a>, and contains 917 GiB and 343 days of Creative Commons-licensed audio from 106,574 tracks from 16,341 artists and 14,854 albums.
In other words, a whole lot of ones and zeroes.</p>

<p>Processing the audio in such a huge dataset would require too much time, so I would have to make do with the preprocessed metadata designating the different features and values for each track. The audio features for each track had been extracted using <a href="https://librosa.github.io/librosa/feature.html">Librosa</a> in <a href="https://www.python.org/">Python</a>, resulting in 518 values per track containing information and different statistics for the various features <a href="https://librosa.github.io/librosa/feature.html">Librosa</a> can extract.
In the end, a file containing a list of all the tracks, their title, artist, and most importantly genre, was used together with a file containing all the audio features for each track. This still meant that I had 106,574*518 datapoints that needed to be organised before using it for machine learning.</p>

<h3 id="selecting-columns-and-rows">Selecting columns and rows</h3>

<p>Much like in an excel table, the data I was working with was organised in a .csv file, which <a href="https://pandas.pydata.org/pandas-docs/stable/#">Pandas</a>, a data analysis toolkit for Python, can store and manipulate in many various ways.
By selecting items with the genres I was looking for and picking the relevant columns, I made a new list of items that could be correlated with the features for each item. This selection numbered 18845 examples which were split with a 70/30 ratio for learning and testing. The last part was to select features and normalise the values.</p>

<h3 id="teaching-the-models">Teaching the models</h3>
<p>I tested four different machine learning algorithms with <a href="https://scikit-learn.org/stable/">Scikit-learn</a> to see how they performed both in accuracy and time. Each model gave an accuracy of its predictions, and using a <a href="https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-time">Jupyter Notebook command</a> I could see how long it took for the CPU to execute a given command.</p>

<p><a href="https://en.wikipedia.org/wiki/Naive_Bayes_classifier#Gaussian_naive_Bayes">Gaussian naïve bayes</a> gave the worst result of the four models with an accuracy of about 66%, but it only took 24.9 ms to train the model.
<a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">K-nearest neighbour</a> was also quick, but it performed much better with an accuracy of about 74%.<br />
The <a href="https://en.wikipedia.org/wiki/Support-vector_machine">Support Vector Machine</a> I tried was much slower to train than the other models, using about 5.44 seconds. It also performed slightly lower than some of the others with about 72% accuracy.
The last model I tried was a <a href="https://en.wikipedia.org/wiki/Multilayer_perceptron">Multilayer Perceptron</a>, which is a basic neural network. This managed to get the best performance with 75% accuracy after tweaking some of the settings, ending up with four hidden layers of six neurons each. It was however also slower to train, taking 3.77 seconds.
Below is a graph of the loss curve showing how the model improved its performance as it learns from the data.</p>

<figure>
<img src="/assets/image/2019_09_20_eigila_loss-curve-eigil.png" width="80%" align="center" />
<figcaption><strong>Loss prediction of MLP</strong></figcaption>
</figure>

<h3 id="results">Results</h3>
<p>Was it really successful?
Probably not. However, the results raise a few questions regarding the dataset, relevant features for genres, and techniques for separating classes better using <a href="https://en.wikipedia.org/wiki/Dimensionality_reduction">dimensionality reduction</a>. It’s all really about how the data is understood and presented for the machine which determines how well it’s going to perform.</p>
</div>

  

  <a class="u-url" href="/machine-learning/2019/09/19/All-about-the-data.html" hidden></a>
</article>

<script src="/utils/slideshow.js"></script>
<script src="https://unpkg.com/wavesurfer.js@5.0.1/dist/wavesurfer.js"></script>
<script src="/utils/waveform.js"></script>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The SMC Blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The SMC Blog</li><li><a class="u-email" href="mailto:cer@create.aau.dk">cer@create.aau.dk</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/smc-aau-cph"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">smc-aau-cph</span></a></li><li><a href="https://www.twitter.com/smc-aau-cph"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">smc-aau-cph</span></a></li><li><a href="https://youtube.com/c/smc-aau-cphr/videos"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username">SMC_master</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS feed</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>The student-led blog of the Aalborg University Copenhagen (AAU-CPH) master&#39;s programme in Sound and Music Computing (SMC).</p>
      </div>
    </div>

  </div>

</footer>


    <!-- include comments here -->

  </body>

</html>
